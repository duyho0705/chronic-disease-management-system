# ---------------------------------------------------------------------------
# Patient Flow & Triage – Main configuration
# Profiles: dev (default), prod
# ---------------------------------------------------------------------------

spring:
  application:
    name: patient-flow-triage

  profiles:
    active: ${SPRING_PROFILES_ACTIVE:dev}

  jpa:
    open-in-view: false
    hibernate:
      ddl-auto: validate
    show-sql: false
    properties:
      hibernate:
        default_schema: public
        jdbc:
          time_zone: UTC
        format_sql: true
    database-platform: org.hibernate.dialect.PostgreSQLDialect

  jackson:
    serialization:
      write-dates-as-timestamps: false
    deserialization:
      fail-on-unknown-properties: true
    default-property-inclusion: non_null

server:
  port: ${SERVER_PORT:8080}
  error:
    include-message: always

# Actuator: health + info; metrics/auditevents off by default in prod
management:
  endpoints:
    web:
      exposure:
        include: health,info
      base-path: /actuator
  endpoint:
    health:
      show-details: when_authorized
  health:
    db:
      enabled: true

# OpenAPI
springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
    operationsSorter: method

# AI Triage (rule-based mặc định; sau có thể thêm provider: openai, rest)
triage:
  ai:
    enabled: true
    model-key: triage_acuity_v1
    provider: rule-based

# Logging
logging:
  level:
    root: INFO
    vn.clinic.patientflow: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
